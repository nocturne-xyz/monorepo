// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.17;

import {Pairing} from "./libs/Pairing.sol";
import {Groth16} from "./libs/Groth16.sol";
import {IJoinSplitVerifier} from "./interfaces/IJoinSplitVerifier.sol";

contract JoinSplitVerifier is IJoinSplitVerifier {
    function verifyingKey()
        internal
        pure
        returns (Groth16.VerifyingKey memory vk)
    {
        vk.alpha1 = Pairing.G1Point(
            20491192805390485299153009773594534940189261866228447918068658471970481763042,
            9383485363053290200918347156157836566562967994039712273449902621266178545958
        );

        vk.beta2 = Pairing.G2Point(
            [
                4252822878758300859123897981450591353533073413197771768651442665752259397132,
                6375614351688725206403948262868962793625744043794305715222011528459656738731
            ],
            [
                21847035105528745403288232691147584728191162732299865338377159692350059136679,
                10505242626370262277552901082094356697409835680220590971873171140371331206856
            ]
        );
        vk.gamma2 = Pairing.G2Point(
            [
                11559732032986387107991004021392285783925812861821192530917403151452391805634,
                10857046999023057135944570762232829481370756359578518086990519993285655852781
            ],
            [
                4082367875863433681332203403145435568316851327593401208105741076214120093531,
                8495653923123431417604973247489272438418190587263600148770280649306958101930
            ]
        );
        vk.delta2 = Pairing.G2Point(
            [
                8233379281913094182198875707163914259658206471926277133536443703586884516046,
                19378265019700928854925852953811979290481682835532068157853544504582366178012
            ],
            [
                15349574183686274995654455534142454707479777780796651544662858915386755561509,
                6218614925979059085561905978617527939323898736320386756110283642939011056445
            ]
        );
        vk.IC = new Pairing.G1Point[](13);

        vk.IC[0] = Pairing.G1Point(
            14144020851981313197090654194400793949881109141939767666644553948275343452588,
            10470662614609593119604601597315394752583390635872294567344320144310659203767
        );
        vk.IC[1] = Pairing.G1Point(
            11018479467834915369394305840585693455426717925977164473741215572307153697017,
            3024780472655494068876648646016089130417570338237612299666301285563059043528
        );
        vk.IC[2] = Pairing.G1Point(
            8934943740646655957703982238365131557437634186778506756277563805546499601254,
            7533330841239569655757017333394837862907789749920988036431828259011120805037
        );
        vk.IC[3] = Pairing.G1Point(
            2666346966718162469861622378162644044839416152498852543739357133630896676410,
            7226911295463017438858320090290443661121807883011388805169050270622718964457
        );
        vk.IC[4] = Pairing.G1Point(
            488358096016077482682562629304219875464818148597825115519023094645445268839,
            19580818487516127826336203994368588842013576307773223824660013466867913459369
        );
        vk.IC[5] = Pairing.G1Point(
            19188289070886178779457880922446841201010283709589133607100605231922721819136,
            15452542671564987962247130905817306083158095997213821571677325902049490890419
        );
        vk.IC[6] = Pairing.G1Point(
            9561244917535683385117795331295777324982008054806208260185152218138798921716,
            19227382046531152562800120114500274576916146037388305222924193185194392877294
        );
        vk.IC[7] = Pairing.G1Point(
            8213369802240429140041618458603720692270651059713485082143466074064494724376,
            13020483426867002185039597570423566836445659697105558653884509452584273291683
        );
        vk.IC[8] = Pairing.G1Point(
            14031467173092204272900378331271090710804854745251361529770453381478427402017,
            1041493152911258098299165660326052183931151885956007818754665415467983637566
        );
        vk.IC[9] = Pairing.G1Point(
            594173857857960132263819450307914463518651374545677592384457245328792643737,
            6573648876108064063714666581555401486522133764711423229776238272394869625112
        );
        vk.IC[10] = Pairing.G1Point(
            10192805695883986268412558179411508482510860473565449230661186196507560742898,
            14012071020145162083145111717291961954134487874496925007375416354627698373310
        );
        vk.IC[11] = Pairing.G1Point(
            15006453344931615461595331255395821320905841000528487899752733213471806235778,
            4254484473598858803637285369806356225642200961802774713699170622203023655380
        );
        vk.IC[12] = Pairing.G1Point(
            4137420317614958980890023954660058162813862712584378159925823682677094780130,
            6753499347122190528505814228786979033267141403997445944873983072422907659796
        );
    }

    /// @return r  bool true if proof is valid
    function verifyProof(
        uint256[8] memory proof,
        uint256[] memory pi
    ) public view override returns (bool r) {
        return Groth16.verifyProof(verifyingKey(), proof, pi);
    }

    /// @return r bool true if proofs are valid
    function batchVerifyProofs(
        uint256[8][] memory proofs,
        uint256[][] memory allPis
    ) public view override returns (bool) {
        return Groth16.batchVerifyProofs(verifyingKey(), proofs, allPis);
    }
}
